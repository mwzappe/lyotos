from lyotos.util import xp, darray
from scipy.interpolate import CubicSpline

from .material import Material

water_table = darray([
    [2.000e+02,1.396e+00,1.100e-07],
    [2.250e+02,1.373e+00,4.900e-08],
    [2.500e+02,1.362e+00,3.350e-08],
    [2.750e+02,1.354e+00,2.350e-08],
    [3.000e+02,1.349e+00,1.600e-08],
    [3.250e+02,1.346e+00,1.080e-08],
    [3.500e+02,1.343e+00,6.500e-09],
    [3.750e+02,1.341e+00,3.500e-09],
    [4.000e+02,1.339e+00,1.860e-09],
    [4.250e+02,1.338e+00,1.300e-09],
    [4.500e+02,1.337e+00,1.020e-09],
    [4.750e+02,1.336e+00,9.350e-10],
    [5.000e+02,1.335e+00,1.000e-09],
    [5.250e+02,1.334e+00,1.320e-09],
    [5.500e+02,1.333e+00,1.960e-09],
    [5.750e+02,1.333e+00,3.600e-09],
    [6.000e+02,1.332e+00,1.090e-08],
    [6.250e+02,1.332e+00,1.390e-08],
    [6.500e+02,1.331e+00,1.640e-08],
    [6.750e+02,1.331e+00,2.230e-08],
    [7.000e+02,1.331e+00,3.350e-08],
    [7.250e+02,1.330e+00,9.150e-08],
    [7.500e+02,1.330e+00,1.560e-07],
    [7.750e+02,1.330e+00,1.480e-07],
    [8.000e+02,1.329e+00,1.250e-07],
    [8.250e+02,1.329e+00,1.820e-07],
    [8.500e+02,1.329e+00,2.930e-07],
    [8.750e+02,1.328e+00,3.910e-07],
    [9.000e+02,1.328e+00,4.860e-07],
    [9.250e+02,1.328e+00,1.060e-06],
    [9.500e+02,1.327e+00,2.930e-06],
    [9.750e+02,1.327e+00,3.480e-06],
    [1.000e+03,1.327e+00,2.890e-06],
    [1.200e+03,1.324e+00,9.890e-06],
    [1.400e+03,1.321e+00,1.380e-04],
    [1.600e+03,1.317e+00,8.550e-05],
    [1.800e+03,1.312e+00,1.150e-04],
    [2.000e+03,1.306e+00,1.100e-03],
    [2.200e+03,1.296e+00,2.890e-04],
    [2.400e+03,1.279e+00,9.560e-04],
    [2.600e+03,1.242e+00,3.170e-03],
    [2.650e+03,1.219e+00,6.700e-05],
    [2.700e+03,1.188e+00,1.900e-02],
    [2.750e+03,1.157e+00,5.900e-02],
    [2.800e+03,1.142e+00,1.150e-01],
    [2.850e+03,1.149e+00,1.850e-01],
    [2.900e+03,1.201e+00,2.680e-01],
    [2.950e+03,1.292e+00,2.980e-01],
    [3.000e+03,1.371e+00,2.720e-01],
    [3.050e+03,1.426e+00,2.400e-01],
    [3.100e+03,1.467e+00,1.920e-01],
    [3.150e+03,1.483e+00,1.350e-01],
    [3.200e+03,1.478e+00,9.240e-02],
    [3.250e+03,1.467e+00,6.100e-02],
    [3.300e+03,1.450e+00,3.680e-02],
    [3.350e+03,1.432e+00,2.610e-02],
    [3.400e+03,1.420e+00,1.950e-02],
    [3.450e+03,1.410e+00,1.320e-02],
    [3.500e+03,1.400e+00,9.400e-03],
    [3.600e+03,1.385e+00,5.150e-03],
    [3.700e+03,1.374e+00,3.600e-03],
    [3.800e+03,1.364e+00,3.400e-03],
    [3.900e+03,1.357e+00,3.800e-03],
    [4.000e+03,1.351e+00,4.600e-03],
    [4.100e+03,1.346e+00,5.620e-03],
    [4.200e+03,1.342e+00,6.880e-03],
    [4.300e+03,1.338e+00,8.450e-03],
    [4.400e+03,1.334e+00,1.030e-02],
    [4.500e+03,1.332e+00,1.340e-02],
    [4.600e+03,1.330e+00,1.470e-02],
    [4.700e+03,1.330e+00,1.570e-02],
    [4.800e+03,1.330e+00,1.500e-02],
    [4.900e+03,1.328e+00,1.370e-02],
    [5.000e+03,1.325e+00,1.240e-02],
    [5.100e+03,1.322e+00,1.110e-02],
    [5.200e+03,1.317e+00,1.010e-02],
    [5.300e+03,1.312e+00,9.800e-03],
    [5.400e+03,1.305e+00,1.030e-02],
    [5.500e+03,1.298e+00,1.160e-02],
    [5.600e+03,1.289e+00,1.420e-02],
    [5.700e+03,1.277e+00,2.030e-02],
    [5.800e+03,1.262e+00,3.300e-02],
    [5.900e+03,1.248e+00,6.220e-02],
    [6.000e+03,1.265e+00,1.070e-01],
    [6.100e+03,1.319e+00,1.310e-01],
    [6.200e+03,1.363e+00,8.800e-02],
    [6.300e+03,1.357e+00,5.700e-02],
    [6.400e+03,1.347e+00,4.490e-02],
    [6.500e+03,1.339e+00,3.920e-02],
    [6.600e+03,1.334e+00,3.560e-02],
    [6.700e+03,1.329e+00,3.370e-02],
    [6.800e+03,1.324e+00,3.270e-02],
    [6.900e+03,1.321e+00,3.220e-02],
    [7.000e+03,1.317e+00,3.200e-02]
])

water_simple_interp = CubicSpline(water_table[:,0], water_table[:, 1])

def water_simple_n(nu):
    return water_simple_interp(nu)

class WaterSimple(Material):
    def __init__(self):
        super().__init__(water_simple_n)

                     
Water = WaterSimple()
